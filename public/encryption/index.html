<html>
  <head>
    <meta charset="UTF-8">
    <meta name="author" content="HG King">
    <link rel="apple-touch-icon" href="../favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel='stylesheet' href='https://www.hgking.xyz/css/deco.css' type='text/css'>
    <script src='https://www.hgking.xyz/js/deco.js'></script>
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans|Limelight" rel="stylesheet">
    <title>RSA Encryption</title>
    <script>

      var state = "initial"

      function keygen()  {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("keys_landing").innerHTML = this.responseText;
          }
        };
        document.getElementById("keys_landing").innerHTML = "Generating keys..."
        p = document.getElementById("p").value
        q = document.getElementById("q").value
        xhttp.open("GET", "/encryption/keygen/?p=" + p + "&q=" + q, true);
        xhttp.send();
        state = "keys"
      }

      function encrypt()  {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("encrypt_landing").innerHTML = this.responseText;
          }
        };
        document.getElementById("encrypt_landing").innerHTML = "Encrypting..."
        p = document.getElementById("p").value
        q = document.getElementById("q").value
        m = document.getElementById("m").value
        xhttp.open("GET", "/encryption/encrypt/?m=" + m + "&p=" + p + "&q=" + q, true);
        xhttp.send();
        state = "encrypted"
      }

      function decrypt()  {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("decrypt_landing").innerHTML = this.responseText;
          }
        };
        document.getElementById("decrypt_landing").innerHTML = "Decrypting..."
        p = document.getElementById("p").value
        q = document.getElementById("q").value
        m = document.getElementById("m").value
        xhttp.open("GET", "/encryption/decrypt/?m=" + m + "&p=" + p + "&q=" + q, true);
        xhttp.send();
        state = "decrypted"
      }
    </script>
  </head>
  <body>
    <div class='center _2-3rd text-center'>
      <div id='header' class='deco'>
        <h1 id="title" class="deco-title">RSA Encryption</h1>
        <h2 id="description" class="deco-description">Created By HG King</h2>
      </div>
    </div>
    <main>
      <div class='_2-3rd center'>
        <div class='row deco card deco-form'>
          <h2>Step 1 - Key Generation</h2>
          <h3>Enter two primes!</h3>
          <div class='row'>
            <label for='p'>P:</label>
            <input id='p' name='p' type='number'>
          </div>
          <div class='row'>
            <label for='q'>Q:</label>
            <input id='q' name='q' type='number'>
          </div>
          <div class='row'>
            <button onclick='keygen()'>Generate Keys</button>
          </div>
          <div class='row'>
            <div id='keys_landing' class='_half left'></div>
            <div class='_half right text-center'>
              <p>To generate the keys...</p>
              <p>Choose two distinct prime numbers p and q.</p>
              <p>Compute <code>n = pq</code>.</p>
              <p>Compute <code>λ(n) = lcm(λ(p), λ(q)),</code></p>
              <p>simplified to <code>λ(n) = lcm(p − 1, q − 1)</code>,</p>
              <p>where λ is Carmichael's totient function.</p>
              <p>Choose an integer e such that <code>1 &lt e &lt λ(n)</code> and <code>gcd(e, λ(n)) = 1</code>.</p>
              <p>Determine d as <code>d ≡ e−1 (mod λ(n))</code>; i.e., d is the modular multiplicative inverse of e modulo λ(n).</p>
            </div>
          </div>
        </div>
      </div>
      <br>
      <div class='_2-3rd center'>
        <div class='row deco card deco-form'>
          <h2>Step 2 - Encryption</h2>
          <h3>Enter your message!</h3>
          <div class='row'>
            <label for='m'>M:</label>
            <input id='m' name='m' type='number'>
          </div>
          <div class='row'>
            <button onclick='encrypt()'>Encrypt Message</button>
          </div>
          <div class='row'>
            <div id='encrypt_landing' class='_half left'></div>
            <div class='_half right text-center'>
              <p>Using the public key <code>(e, n)</code>, one can encrypt messages that can only be deciphered by those who posess the private key.</p>
              <p>To encrypt a message, compute:</p>
              <p><code>c ≡ m^e (mod n)</code></p>
              <p>This is rather easy using modular exponentiation so simplify the large power.</p>
            </div>
          </div>
        </div>
      </div>
      <div class='_2-3rd center'>
        <div class='row deco card deco-form'>
          <h2>Step 3 - Decryption</h2>
          <h3>Decrypt the cypher!</h3>
          <div class='row'>
            <button onclick='decrypt()'>Decrypt Message</button>
          </div>
          <div class='row'>
            <div id='decrypt_landing' class='_half left'></div>
            <div class='_half right text-center'>
              <p>To decrypt the message...</p>
              <p>You can recover m from c by using the private key exponent d by computing</p>
              <p><code>c^d ≡ (m^e)^d ≡ m (mod n)</code></p>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div class='center _2-3rd text-center'>
      <div id="footer" class='deco'>
        <footer>
          <p class="footer-text">
          <a href="/about.php">About</a> &#124;
          <a href="/contact.php">Contact Us</a> &#124;
          Copyright &copy;<time datetime="2018">2018</time>
          </p>
        </footer>
      </div>
    </div>
  </body>
</html>
